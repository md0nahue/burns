#!/usr/bin/env ruby

# Create proper segments from transcribed text
text = " My lead source tonight is the independent senator from Vermont, Bernie Sanders. And, Senator, it's great to have you here, because you issued your own rebuke, as I'll call it, and basically said that you think President Trump needs to turn off Fox News and, quote, read the Constitution. Look, you know, the guys who wrote the Constitution back in the 1790s were nobody's fools. What they wanted to do is have a separation of powers between the executive, the legislative, and the judiciary, so that one person could not assume enormous power. And what you are seeing right now is a president who is authoritarian. He just attacked the media the other day. I think he called CNN illegal because I gather that now and then you criticize him. He is trying to encroach on the constitutional responsibilities and spending powers of Congress. And now he's going after the courts. Look, if somebody is a corrupt judge, that person can and should be impeached. But not because you voice an opinion. That's why these guys have life terms. So they are immune from these types of attack and they can be objective in their judgment. And just a word here. In the last number of years, and I'm not a great fan of Chief Justice Roberts, you have had decisions from the Supreme Court on Citizens United, which allowed billionaires to buy elections. One of the worst decisions in the history of the Supreme Court. You didn't see a whole lot of people saying impeach Roberts and members of the court. You had this horrible decision on Roe versus Wade, taking away women's rights to control their own bodies. Again, we live in a society of rule of law. Supreme Court has its power. Judges have their power. And it should frighten every American, whether you're conservative or progressive, that you have a president who does not respect our Constitution and wants more and more power for himself. Very dangerous. What does it say that the Chief Justice, who, that's a great point, you have also criticized decisions that the Supreme Court has made with John Roberts as the Chief Justice, but what does it say that he felt the need to come out and issue this rebuke of Trump tonight? Well, I don't know Roberts all that well. I'm not a great fan of his court. But I think he does understand I suspect the danger of a president who does not respect the Constitution of the United States and wants more and more power for himself It would take 67 senators to remove a judge from the federal bench. That would mean that every Republican would have to vote for it, and I believe 14 Democratsâ€” Ain't going to happen. No, I don't have to go into it. It's not going to happen. Okay, period. But what we have to worry about is this movement toward authoritarianism. Trump admires and loves people. These things, they're great. They're beautiful people when they agree with them. But if you criticize them, you're acting illegally. You should be impeached. You're terrible, et cetera. You're a left-wing fanatic, whatever he calls people. A very dangerous trend. Look, I don't have to tell anybody that we are living in difficult times. And it's not only this movement toward authoritarianism, it's this movement toward oligarchy, where you have a number of billionaires running the United States government, where you're seeing right now with Musk and others massive attacks against veterans and the Veterans Administration. They want to lay off some 80,000 people in the VA who provide health care to our veterans, who make sure they get the benefits that they deserve. You're now seeing a massive attack on Social Security. Presumably, they want people with disabilities to now walk in to some Social Security office, although they're cutting back on these Social Security offices all over this country. And at the end of the day, Caitlin, in my view, you've got a bunch of these oligarchs who want to destroy virtually every program in America that works for working class people so that you have massive tax breaks to the 1% and the billionaire class. And as you may know, I'll be on the road with Alexandria Ocasio-Cortez the next few days trying to fight back against this horrific set of activities. Yeah, you've been on this anti-oligarchy tour. You've been making stops. I mean, it's really notable to see the crowds and how many people are showing up. We're showing one of the pictures of you speaking here and you've been going to all over to Colorado, to Wisconsin, all over the country. I know you have a lot more stops planned next week. What you just said about Elon Musk and what Trump or Trump are doing now that he's back in power it safe to say there a lot of despair in the country over what Democrats are doing how they responding to this You an independent but you caucus with the Democrats I want you to listen to what happened at a town hall tonight with Democratic Congressman Glenn Ivey You aren't even working together on a shared strategy. And that is failure. We are not interested in hearing that you are in the minority. We know that. we want you to show some of the backbone and strategic brilliance that Mitch McConnell would have in the minority is that what you've been hearing out on the road senator I think there's a lot of discontent with the Democratic leadership and I think with the entire Democratic Party and one of the things that I and Alexandria will be trying to do is get people involved in the political process, either as independents or as progressive Democrats, to stand up for a working class in this country, which is being hammered every single day. You know, real inflation accounted for wages have not gone up in 52 years, while the very richest people have become much richer. Our health care system is broken. Our housing system is broken. Our child care system is broken. We're not making the progress we need to address the climate crisis that we face. And yet the majority of the American people believe that we should have a government that works for them and not the few, which is what we have right now. So I hope we can rally the American people in so many ways to understand the critical moment that we're in and to get them to stand up and fight back, not only against Trump, but in the richest country in the history of the world, we should not be the only country, major country, that doesn't guarantee health care to all people, or paid family and medical leave, or have 8,800,000 people sleeping out on the street. We're the richest country in the history of the world. We can have a government and an economy that works well for all. When it comes to that effort in the Senate, do you think Senator Chuck Schumer is the right person to lead it? It's not. I know everyone's beating up on Chuck, and I strongly disagree with him, strongly. No-one is in the caucus more critical of Schumer than I am. But it's not Schumer. It's the caucus. It's not the caucus. It's the Democratic Party. You've got to take a deep breath and understand that you have a Democratic Party You know you got a Republican Party which is owned by Musk Any Republican who defies Donald Trump will be primaried by Musk unlimited amounts of money. In the Democratic Party, you've got a party that is heavily dominated by the billionaire class, run by consultants who are way out of touch with reality. It has, the Democratic Party has virtually no grassroots support. So what we are trying to do is in one way or another maybe create a party within the party of bringing millions of young people, working class people, people of color to demand that the Democratic Party start standing with the working class of this country and take on the very powerful corporate interests that have never had it so good. You've been out on the road hearing that from voters with Congresswoman Alexandria Ocasio-Cortez, as you mentioned. People are saying she should primary Schumer. Do you think she'd be a formidable opponent if she did? I don't want to go. Look, the issue right now is not worrying about a primary three years ago, three years from now, whenever it's going to be. That's media stuff, Caitlin. That's not what people are worried about. It's Democratic voter stuff, too, though. What we have got to do now is wake up the American people. The vast majority of the American people do not believe that we should give tax breaks to billionaires and cut Medicaid, cut Social Security, cut veterans programs, and nutrition. And our job is to rally the people at the grassroots level, have them run for school board or Congress or the Senate on an agenda that says that we're going to stand up for working class people, not the rich. That's what we've got to do in this moment. And certainly, I mean, we have seen this at your town halls and for people who haven't been watching where you've been going. I mean, it's your stops across the country. It's been quite fascinating to see just the audience reaction. Senator, I do want to ask you, because tonight we have breaking news that that President Trump has fired the two Democratic members of the Federal Trade Commission. Usually, the president's party has three seats. The opposing has two on that board. Do you believe that move is illegal? Yeah. I mean, he tried to get rid of the National Labor Relations Board people as well. Look, this is the guy, as I just mentioned a moment ago. He happens not to believe in the rule of law, not to believe in the Constitution, and he will try to exercise his power in any and every way. and the American people have got to stand up and stop them. Senator Bernie Sanders, always appreciate your time, and thanks for taking time out of the tour to join us here on CNN."

# Split text into sentences for segments
sentences = text.split(/[.!?]+/).map(&:strip).reject(&:empty?)

# Create segments with reasonable timing
segments = []
words = []
current_time = 0.0
word_index = 0

sentences.each_with_index do |sentence, i|
  # Estimate duration based on sentence length (roughly 4 words per second)
  sentence_words = sentence.split(/\s+/)
  estimated_duration = [sentence_words.length / 4.0, 3.0].max # minimum 3 seconds
  
  segment = {
    "id" => i,
    "seek" => (current_time * 1000).to_i,
    "start" => current_time.round(2),
    "end" => (current_time + estimated_duration).round(2),
    "text" => " #{sentence}",
    "tokens" => (50365..(50365 + sentence_words.length)).to_a,
    "temperature" => 0.0,
    "avg_logprob" => -0.1,
    "compression_ratio" => 1.5,
    "no_speech_prob" => 1e-12
  }
  
  segments << segment
  
  # Add words
  sentence_words.each_with_index do |word, word_idx|
    word_duration = estimated_duration / sentence_words.length
    word_start = current_time + (word_idx * word_duration)
    word_end = word_start + word_duration
    
    words << {
      "word" => word,
      "start" => word_start.round(2),
      "end" => word_end.round(2),
      "confidence" => 0.9
    }
  end
  
  current_time += estimated_duration
end

# Create the complete transcription result
result = {
  "success" => true,
  "text" => text,
  "segments" => segments,
  "words" => words,
  "duration" => current_time.round(2),
  "language" => "en",
  "task" => "transcribe"
}

# Write to cache file
require 'json'
File.write('cache/b3.json', JSON.pretty_generate(result))

puts "âœ… Created #{segments.length} segments and #{words.length} words"
puts "ğŸ“Š Total duration: #{current_time.round(2)} seconds"
puts "ğŸ’¾ Saved to cache/b3.json"